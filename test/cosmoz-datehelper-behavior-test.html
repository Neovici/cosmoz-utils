<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1, user-scalable=yes">
	<title>cosmoz-datehelper-behavior test</title>

	<script src="../../webcomponentsjs/webcomponents-lite.js"></script>
	<script src="../../web-component-tester/browser.js"></script>
	<script src="../../test-fixture/test-fixture-mocha.js"></script>

	<link rel="import" href="../../test-fixture/test-fixture.html">
	<link rel="import" href="../../iron-test-helpers/iron-test-helpers.html">

	<link rel="import" href="fixtures.html">
</head>

<body>

	<test-fixture id="cosmoz-datehelper-behavior-fixture">
		<template>
			<test-cosmoz-datehelper-behavior></test-cosmoz-datehelper-behavior>
		</template>
	</test-fixture>

	<script type="text/javascript">
		(function () {
			'use strict';

			suite('cosmoz-datehelper-behavior', () => {
				let dateHelper,
					undefinedDate,
					dateHourAgo;

				const date = new Date('October 13, 2014 11:13:20'),
					futureDate = new Date('October 13, 2022 11:13:20'),
					invalidDate = '',
					dateWeekDiff = new Date(date.getTime() - 1000 * 60 * 60 * 24 * 7);


				setup(() => {
					dateHelper = fixture('cosmoz-datehelper-behavior-fixture');
					const dateNow = new Date();
					dateHourAgo = new Date(dateNow.getTime() - 60 * 60 * 1000);
				});

				test('ensureDate', done => {
					assert.equal(dateHelper.ensureDate(undefined), undefined);
					assert.equal(dateHelper.ensureDate(date), date);
					const dateObj = dateHelper.ensureDate('October 13, 2014 11:13:20');
					assert.equal(dateObj instanceof Date, true);
					assert.equal(dateHelper.ensureDate(invalidDate), undefined);
					assert.equal(dateHelper.ensureDate('abc'), undefined);
					assert.equal(dateHelper.ensureDate(null), undefined);
					done();
				});

				test('isoDate()', done => {
					assert.equal(dateHelper.isoDate(invalidDate), '');
					assert.equal(dateHelper.isoDate(undefinedDate), '');
					assert.equal(dateHelper.isoDate(date), '2014-10-13');
					done();
				});

				test('isoDT()', done => {
					assert.equal(dateHelper.isoDT(invalidDate), '');
					assert.equal(dateHelper.isoDT(undefinedDate), '');
					assert.equal(dateHelper.isoDT(date), '2014-10-13 11:13:20');
					done();
				});

				test('pastDate', done => {
					assert.isTrue(dateHelper.pastDate(date));
					assert.isFalse(dateHelper.pastDate(futureDate));
					done();
				});

				test('renderDate, renderDateTime', done => {
					assert.equal(dateHelper.renderDate(date), dateHelper.isoDate(date));
					assert.equal(dateHelper.renderDatetime(date), dateHelper.isoDT(date));
					done();
				});

				test('timeago one hour', done => {
					assert.equal(dateHelper.timeago(dateHourAgo), 'an hour ago');
					done();
				});

				test('timediff a week', done => {
					assert.equal(dateHelper.dayDiff(date, dateWeekDiff), 7);
					done();
				});

			});
		})();
	</script>
</body>

</html>