<link rel="import" href="../polymer/polymer.html">
<script type="text/javascript" src="../accounting/accounting.min.js"></script>
<script type="text/javascript">
(function () {
	'use strict';
	/* global accounting */
	window.Cosmoz = window.Cosmoz || {};

	var formats = {
		CNY: {
			currency: {
				symbol: '¥',   // default currency symbol is '$'
				format: '%s %v', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: ',',  // decimal point separator
				thousand: ' ',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ',',
				decimal: '.'
			}
		},
		DKK: {
			currency: {
				symbol: 'kr',   // default currency symbol is '$'
				format: '%v %s', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: ',',  // decimal point separator
				thousand: ' ',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ',',
				decimal: '.'
			}
		},
		EUR: {
			currency: {
				symbol: '€',   // default currency symbol is '$'
				format: '%s %v', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: ',',  // decimal point separator
				thousand: '.',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ',',
				decimal: '.'
			}
		},
		NOK: {
			currency: {
				symbol: 'kr',   // default currency symbol is '$'
				format: '%v %s', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: ',',  // decimal point separator
				thousand: ' ',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ',',
				decimal: '.'
			}
		},
		SEK: {
			currency: {
				symbol: 'kr',   // default currency symbol is '$'
				format: '%v %s', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: ',',  // decimal point separator
				thousand: ' ',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ',',
				decimal: '.'
			}
		},
		USD: {
			currency: {
				symbol: '$',   // default currency symbol is '$'
				format: '%s %v', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: '.',  // decimal point separator
				thousand: ',',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ',',
				decimal: '.'
			}
		},
		ZAR: {
			currency: {
				symbol: 'ZAR',   // default currency symbol is '$'
				format: '%s %v', // controls output: %s = symbol, %v = value/number (can be object: see below)
				decimal: ',',  // decimal point separator
				thousand: ' ',  // thousands separator
				precision: 2   // decimal places
			},
			number: {
				precision: 0,  // default precision on numbers is 0
				thousand: ' ',
				decimal: ','
			}
		}
	};

	/**
	 * @polymerBehavior Cosmoz.MoneyHelperBehavior
	 * @demo
	 */
	Cosmoz.MoneyHelperBehavior = {
		renderAmount(money) {
			if (money == null) {
				return;
			}
			const format = this._renderFormat(money);
			return accounting.formatMoney(money.amount, format.currency);
		},
		renderMoney(money) {
			return this.renderAmount(money);
		},
		renderNumberAmount(money) {
			var format = this._renderFormat(money);
			return accounting.formatNumber(money.amount, format.currency);
		},
		unformatRenderedAmount(amountString, decimalSeparator) {
			return accounting.unformat(amountString, decimalSeparator === ',' ? ',' : '');
		},
		round(number, precision) {
			return parseFloat(accounting.toFixed(number, precision));
		},
		_renderFormat(money) {
			if (money === undefined) {
				return;
			}
			if (money.amount === undefined || money.currency === undefined) {
				return (money.amount === undefined
					? ''
					: money.amount) + ' ' + (money.currency === undefined
					? ''
					: money.currency);
			}
			var format = formats[money.currency];
			if (!format) {
				return money.amount + ' ' + money.currency;
			}
			return format;
		}
	};
}());
</script>
